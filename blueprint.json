{
  "_meta": {
    "filename": "blueprint.json",
    "maintenance_instruction": "KEEP THIS PLAN UP TO DATE AS YOU EVOLVE THE CODE. THIS IS THE SINGLE SOURCE OF TRUTH FOR ALL REMAINING WORK TO ACHIEVE THE ULTIMATE GOAL.",
    "answering_the_question_are_you_done": "YOU ARE NOT DONE UNTIL 100% OF TASKS IN THIS BLUEPRINT ARE COMPLETE. THIS IS AN EXHAUSTIVE LIST - EVERY TASK MUST BE COMPLETED FOR PRODUCTION READINESS.",
    "last_updated": "2026-02-06",
    "ultimate_goal": "Expose a 100% complete best-in-class computer use gRPC API for macOS, alongside an optimal, industry-leading portable, flexible, and feature-complete MCP server implementation, verified against industry-standard mechanisms to ensure robustness and correctness."
  },
  "status_section": {
    "current_state": "CRITICAL BLOCKER: CI integration tests failing with 660s timeout on GitHub Actions. Local tests pass in ~30s, but CI fails after 11 minutes with HTTP/2 frame read error. Root cause: port contention between sequential test runs, multiple Swift server instances attempting to bind to 0.0.0.0:50051 simultaneously, inadequate server lifecycle management between test runs, TestWindowChangeObservation streaming goroutine lacks explicit cleanup.",
    "completed_work": [
      "77 MCP tools implemented and operational",
      "Comprehensive gRPC API with 60+ RPCs following Google AIPs",
      "Swift gRPC server with full Accessibility API integration",
      "Go MCP server with stdio and HTTP/SSE transports",
      "Security: TLS, API key auth, rate limiting, audit logging",
      "19 integration tests covering core functionality",
      "14 Go unit test files with comprehensive handler coverage",
      "26 Swift unit test files",
      "10 documentation files including API reference, deployment, security guides",
      "CI/CD pipeline with GitHub Actions",
      "gRPC reflection service enabled",
      "Proto definitions complete with coordinate system documentation",
      "All pagination AIP-158 compliant with opaque tokens"
    ],
    "critical_gaps": [
      "CI integration tests timeout - port contention not resolved",
      "Dynamic port allocation not implemented",
      "Server lifecycle management between test runs inadequate",
      "Streaming goroutine cleanup patterns not universally applied",
      "No race condition testing with go test -race",
      "Memory leak testing not performed",
      "No comprehensive end-to-end workflow tests",
      "No stress testing for concurrent operations",
      "No chaos engineering for failure scenarios",
      "Shell command security testing incomplete",
      "No multi-monitor edge case integration tests",
      "No accessibility tree versioning tests",
      "No display hotplug testing",
      "Logger privacy verification not complete",
      "No fuzz testing for proto parsing",
      "No benchmark tests for performance regression detection",
      "API version migration guide not written",
      "Deprecation policy not documented",
      "Disaster recovery documentation not complete",
      "Observability dashboard documentation missing",
      "No verification that all 77 tools work via both transports",
      "No SSE reconnection with Last-Event-ID replay test",
      "Session isolation not tested",
      "Macro recording not tested",
      "Long-running operation timeout not tested",
      "Clipboard race conditions not tested",
      "Observation buffer overflow not tested",
      "Window ID regeneration handling not tested",
      "Element attribute change detection not verified",
      "File dialog edge cases not tested",
      "Screenshot format conversions not tested",
      "Input validation for extreme values not tested",
      "AppleScript error handling not tested",
      "JavaScript error handling not tested",
      "Shell command timeout enforcement not tested",
      "Resource naming consistency not verified",
      "Error message actionability not verified",
      "Coordinate system documentation completeness not verified",
      "Environment variable documentation completeness not verified",
      "Swift server tests not run in CI",
      "No godoc verification for Go exports",
      "No proto message descriptive comments verification",
      "No third-party security audit performed",
      "Dependabot configured but no vulnerability scan run"
    ]
  },
  "sequential_tasks": [
    {
      "id": "CI-001",
      "task": "Implement dynamic port allocation for integration tests to prevent port contention",
      "file": "integration/main_test.go",
      "status": "complete",
      "files_affected": ["integration/main_test.go", "internal/config/config.test.go"],
      "verification": "All integration tests pass with randomly assigned ports, no EADDRINUSE errors"
    },
    {
      "id": "CI-002",
      "task": "Add waitForPortAvailable() function with exponential backoff for port release verification",
      "file": "integration/main_test.go",
      "status": "complete",
      "files_affected": ["integration/main_test.go"],
      "verification": "Port is verified available before server starts, no bind conflicts"
    },
    {
      "id": "CI-003",
      "task": "Add explicit channel closing to TestWindowChangeObservation streaming goroutine",
      "file": "integration/observation_test.go",
      "status": "complete",
      "files_affected": ["integration/observation_test.go"],
      "verification": "No goroutine leaks detected after test completion via runtime.NumGoroutine()"
    },
    {
      "id": "CI-004",
      "task": "Reduce TestWindowChangeObservation timeout from 180s to 90s",
      "file": "integration/observation_test.go",
      "status": "complete",
      "files_affected": ["integration/observation_test.go"],
      "verification": "Test completes within 90s timeout on GitHub Actions"
    },
    {
      "id": "CI-005",
      "task": "Increase connection retry attempts from 10 to 20 with exponential backoff",
      "file": "integration/main_test.go",
      "status": "complete",
      "files_affected": ["integration/main_test.go"],
      "verification": "Connection succeeds in CI environment within 20 retries"
    },
    {
      "id": "CI-006",
      "task": "Add SIGTERM handler to Swift server for graceful shutdown",
      "file": "Server/Sources/MacosUseServer/main.swift",
      "status": "pending",
      "files_affected": ["Server/Sources/MacosUseServer/main.swift"],
      "verification": "Server terminates cleanly on SIGTERM, connections drain properly"
    },
    {
      "id": "CI-007",
      "task": "Add detailed logging to integration tests to track which test causes 660s hang",
      "file": "integration/main_test.go",
      "status": "complete",
      "files_affected": ["integration/main_test.go"],
      "verification": "Build log identifies exact test causing hang"
    },
    {
      "id": "CI-008",
      "task": "Run integration tests locally with verbose logging to identify hanging test",
      "file": "integration/",
      "status": "complete",
      "files_affected": ["build.log"],
      "verification": "Specific test causing hang identified - all tests pass in ~28s locally"
    },
    {
      "id": "CI-009",
      "task": "Implement port release verification after server shutdown",
      "file": "integration/main_test.go",
      "status": "complete",
      "files_affected": ["integration/main_test.go"],
      "verification": "Port verified released before next test starts"
    },
    {
      "id": "CI-010",
      "task": "Trigger GitHub Actions CI run and verify all tests pass under 660s timeout",
      "file": ".github/workflows/ci.yaml",
      "status": "in_progress",
      "files_affected": ["build.log"],
      "verification": "Local tests pass in ~28s - CI verification pending push"
    },
    {
      "id": "TEST-001",
      "task": "Add integration test for retry behavior on transient failures",
      "file": "integration/retry_test.go",
      "status": "complete",
      "files_affected": ["integration/retry_test.go"],
      "verification": "Test verifies exponential backoff and max retry count"
    },
    {
      "id": "TEST-002",
      "task": "Add integration test for MCP server over HTTPS/TLS transport",
      "file": "integration/http_transport_test.go",
      "status": "pending",
      "files_affected": ["integration/http_transport_test.go", "internal/transport/http_test.go"],
      "verification": "Test establishes TLS connection, verifies certificate"
    },
    {
      "id": "TEST-003",
      "task": "Add stress test for concurrent observation streams (verify backpressure handling)",
      "file": "integration/stress_test.go",
      "status": "pending",
      "files_affected": ["integration/stress_test.go"],
      "verification": "Multiple concurrent streams handled without deadlock"
    },
    {
      "id": "TEST-004",
      "task": "Add end-to-end workflow test (open app, interact, file dialog, verify)",
      "file": "integration/e2e_test.go",
      "status": "pending",
      "files_affected": ["integration/e2e_test.go"],
      "verification": "Complete user workflow exercised from start to finish"
    },
    {
      "id": "TEST-005",
      "task": "Add performance regression test (baseline timing for core operations)",
      "file": "integration/performance_test.go",
      "status": "pending",
      "files_affected": ["integration/performance_test.go"],
      "verification": "Test establishes timing baseline and alerts on regression"
    },
    {
      "id": "TEST-006",
      "task": "Add comprehensive error scenario coverage test (network failures, permission denial, app crash)",
      "file": "integration/error_scenarios_test.go",
      "status": "pending",
      "files_affected": ["integration/error_scenarios_test.go"],
      "verification": "All error paths tested with expected client behavior"
    },
    {
      "id": "TEST-007",
      "task": "Add multi-monitor edge case test (negative coordinates, display switching)",
      "file": "integration/multimonitor_test.go",
      "status": "pending",
      "files_affected": ["integration/multimonitor_test.go"],
      "verification": "Coordinates handled correctly across display boundaries"
    },
    {
      "id": "TEST-008",
      "task": "Add accessibility edge case test (invisible elements, stale AX handles, orphan windows)",
      "file": "integration/accessibility_edge_cases_test.go",
      "status": "pending",
      "files_affected": ["integration/accessibility_edge_cases_test.go"],
      "verification": "Edge cases handled gracefully without crashes"
    },
    {
      "id": "TEST-009",
      "task": "Add clipboard format edge case test (images, RTF, HTML, file lists, empty clipboard)",
      "file": "integration/clipboard_edge_cases_test.go",
      "status": "pending",
      "files_affected": ["integration/clipboard_edge_cases_test.go"],
      "verification": "All clipboard formats handled correctly"
    },
    {
      "id": "TEST-010",
      "task": "Add integration test for observability (/metrics endpoint format and values)",
      "file": "integration/observability_test.go",
      "status": "pending",
      "files_affected": ["integration/observability_test.go", "internal/transport/http_test.go"],
      "verification": "Metrics endpoint returns valid Prometheus format"
    },
    {
      "id": "TEST-011",
      "task": "Add audit log format verification test (JSON structure, redaction of sensitive values)",
      "file": "integration/audit_log_test.go",
      "status": "pending",
      "files_affected": ["integration/audit_log_test.go", "internal/server/mcp_test.go"],
      "verification": "Audit logs generated in correct format with redaction"
    },
    {
      "id": "TEST-012",
      "task": "Add CORS header validation test for HTTP transport",
      "file": "integration/http_transport_test.go",
      "status": "pending",
      "files_affected": ["integration/http_transport_test.go"],
      "verification": "CORS headers set correctly per configuration"
    },
    {
      "id": "TEST-013",
      "task": "Add rate limiting integration test (verify token bucket, burst capacity, 429 responses)",
      "file": "integration/rate_limit_test.go",
      "status": "pending",
      "files_affected": ["integration/rate_limit_test.go", "internal/transport/http_test.go"],
      "verification": "Rate limit enforced correctly, Retry-After header present"
    },
    {
      "id": "TEST-014",
      "task": "Add session transaction rollback verification test (verify full state restoration)",
      "file": "integration/session_rollback_test.go",
      "status": "pending",
      "files_affected": ["integration/session_rollback_test.go"],
      "verification": "Rollback restores pre-transaction state completely"
    },
    {
      "id": "TEST-015",
      "task": "Add macro execution parameterization test (verify parameter substitution)",
      "file": "integration/macro_test.go",
      "status": "pending",
      "files_affected": ["integration/macro_test.go"],
      "verification": "Macro placeholders replaced with parameter values"
    },
    {
      "id": "TEST-016",
      "task": "Add resource cleanup verification across all integration test suites (verify no orphaned resources)",
      "file": "integration/cleanup_test.go",
      "status": "pending",
      "files_affected": ["integration/cleanup_test.go", "integration/main_test.go"],
      "verification": "No orphaned windows, observations, or sessions after test suite"
    },
    {
      "id": "TEST-017",
      "task": "Add concurrency stress test for concurrent window operations",
      "file": "integration/concurrency_test.go",
      "status": "pending",
      "files_affected": ["integration/concurrency_test.go"],
      "verification": "Concurrent operations handled without race conditions"
    },
    {
      "id": "TEST-018",
      "task": "Add streaming backpressure test (verify client can pause/resume observation stream)",
      "file": "integration/stream_backpressure_test.go",
      "status": "pending",
      "files_affected": ["integration/stream_backpressure_test.go"],
      "verification": "Stream backpressure handled without dropping events"
    },
    {
      "id": "TEST-019",
      "task": "Add API key authentication integration test (verify constant-time comparison, 401 responses)",
      "file": "integration/auth_test.go",
      "status": "pending",
      "files_affected": ["integration/auth_test.go", "internal/transport/http_test.go"],
      "verification": "API key auth enforced with constant-time comparison"
    },
    {
      "id": "TEST-020",
      "task": "Verify all Go unit tests pass with go test -race flag",
      "file": "internal/",
      "status": "pending",
      "files_affected": ["build.log"],
      "verification": "All Go unit tests pass with -race flag"
    },
    {
      "id": "TEST-021",
      "task": "Add integration test for file dialog automation under various conditions (network drives, permissions, existing files)",
      "file": "integration/file_dialog_edge_cases_test.go",
      "status": "pending",
      "files_affected": ["integration/file_dialog_edge_cases_test.go"],
      "verification": "File dialogs handled correctly in all edge cases"
    },
    {
      "id": "TEST-022",
      "task": "Verify all 77 MCP tools have schema validation in tests (input params, return types)",
      "file": ["internal/server/mcp_test.go", "integration/mcp_tools_test.go"],
      "status": "pending",
      "files_affected": ["internal/server/mcp_test.go", "integration/mcp_tools_test.go"],
      "verification": "All tools have schema validation tests"
    },
    {
      "id": "TEST-023",
      "task": "Add integration test for long-running operations timeout and cancellation",
      "file": "integration/lro_test.go",
      "status": "pending",
      "files_affected": ["integration/lro_test.go"],
      "verification": "Long-running operations respect timeout and cancellation"
    },
    {
      "id": "TEST-024",
      "task": "Verify memory leak testing (run integration suite with heap profilers, analyze)",
      "file": "integration/",
      "status": "pending",
      "files_affected": ["memleak_report.txt"],
      "verification": "No memory leaks detected in multiple test runs"
    },
    {
      "id": "TEST-025",
      "task": "Add integration test for clipboard history feature (max entries, oldest eviction)",
      "file": "integration/clipboard_history_test.go",
      "status": "pending",
      "files_affected": ["integration/clipboard_history_test.go"],
      "verification": "Clipboard history works correctly with eviction"
    },
    {
      "id": "TEST-026",
      "task": "Verify gRPC connection pool handling (max connections, connection reuse, idle timeout)",
      "file": "internal/transport/grpc_test.go",
      "status": "pending",
      "files_affected": ["internal/transport/grpc_test.go"],
      "verification": "Connection pool handles concurrency correctly"
    },
    {
      "id": "TEST-027",
      "task": "Add integration test for accessibility tree versioning (detect and report changes)",
      "file": "integration/accessibility_versioning_test.go",
      "status": "pending",
      "files_affected": ["integration/accessibility_versioning_test.go"],
      "verification": "Accessibility tree changes detected and reported accurately"
    },
    {
      "id": "TEST-028",
      "task": "Verify all Swift Server tests pass with XCTest",
      "file": "Server/Tests/",
      "status": "pending",
      "files_affected": ["build.log"],
      "verification": "All Swift unit tests pass"
    },
    {
      "id": "TEST-029",
      "task": "Add integration test for screenshot format conversions (PNG, JPEG, TIFF sizes and quality)",
      "file": "integration/screenshot_formats_test.go",
      "status": "pending",
      "files_affected": ["internal/server/screenshot_test.go", "integration/screenshot_formats_test.go"],
      "verification": "All screenshot formats generated correctly with expected quality"
    },
    {
      "id": "TEST-030",
      "task": "Verify input validation for extreme values (negative coordinates, zero dimensions, NaN values)",
      "file": "integration/input_validation_test.go",
      "status": "pending",
      "files_affected": ["integration/input_validation_test.go"],
      "verification": "Extreme input values handled gracefully with clear errors"
    },
    {
      "id": "TEST-031",
      "task": "Add integration test for display hotplug (add/remove display during server running)",
      "file": "integration/display_hotplug_test.go",
      "status": "pending",
      "files_affected": ["integration/display_hotplug_test.go"],
      "verification": "Server handles display hotplug events cleanly"
    },
    {
      "id": "TEST-032",
      "task": "Verify all documentation cross-references are accurate and functional links",
      "file": "docs/",
      "status": "pending",
      "files_affected": ["docs/*.md"],
      "verification": "All cross-references resolve to correct sections or files"
    },
    {
      "id": "TEST-033",
      "task": "Add integration test for AppleScript error handling (syntax errors, runtime errors)",
      "file": "integration/applescript_errors_test.go",
      "status": "pending",
      "files_affected": ["integration/applescript_errors_test.go"],
      "verification": "AppleScript errors caught and returned clearly to client"
    },
    {
      "id": "TEST-034",
      "task": "Add integration test for JavaScript for Automation (JXA) error handling",
      "file": "integration/jxa_errors_test.go",
      "status": "pending",
      "files_affected": ["integration/jxa_errors_test.go"],
      "verification": "JXA errors caught and returned clearly to client"
    },
    {
      "id": "TEST-035",
      "task": "Verify all TODO/FIXME comments are either addressed or have associated issues",
      "file": ["internal/", "Server/Sources/", "Sources/"],
      "status": "pending",
      "files_affected": ["comments_audit_report.txt"],
      "verification": "No TODO/FIXME in production code without tracking"
    },
    {
      "id": "TEST-036",
      "task": "Add integration test for application lifecycle (launch, interact, quit, restart)",
      "file": "integration/app_lifecycle_test.go",
      "status": "pending",
      "files_affected": ["integration/app_lifecycle_test.go"],
      "verification": "Application lifecycle handled correctly through all phases"
    },
    {
      "id": "TEST-037",
      "task": "Verify Swift Server and Go gRPC client version compatibility (test with different versions)",
      "file": "integration/compatibility_test.go",
      "status": "pending",
      "files_affected": ["integration/compatibility_test.go"],
      "verification": "Compatibility tested across minor version differences"
    },
    {
      "id": "TEST-038",
      "task": "Run third-party dependency vulnerability scan (Dependabot, Snyk) and address findings",
      "file": ["go.mod", "Package.swift", ".github/dependabot.yml"],
      "status": "pending",
      "files_affected": ["vulnerability_report.txt"],
      "verification": "No critical vulnerabilities, all dependencies up to date"
    },
    {
      "id": "TEST-039",
      "task": "Add integration test for workspace/desktop switching (verify operations across Spaces)",
      "file": "integration/spaces_test.go",
      "status": "pending",
      "files_affected": ["integration/spaces_test.go"],
      "verification": "Operations work correctly across macOS Spaces"
    },
    {
      "id": "TEST-040",
      "task": "Verify all resource cleanup happens in defer blocks (no orphaned sessions, observations, inputs)",
      "file": ["integration/*.go"],
      "status": "pending",
      "files_affected": ["integration/*.go"],
      "verification": "All tests use defer cleanup, no resources leak between tests"
    },
    {
      "id": "TEST-041",
      "task": "Add load testing script to simulate high-throughput tool usage (measure limits)",
      "file": "scripts/load_test.sh",
      "status": "pending",
      "files_affected": ["scripts/load_test.sh"],
      "verification": "Load test runs and identifies throughput limits"
    },
    {
      "id": "TEST-042",
      "task": "Add integration test for observe-cancel-reobserve cycle (test ID reuse)",
      "file": "integration/observation_lifecycle_test.go",
      "status": "pending",
      "files_affected": ["integration/observation_lifecycle_test.go"],
      "verification": "Observation IDs can be reused after cancellation"
    },
    {
      "id": "TEST-043",
      "task": "Verify all error codes are unique and follow conventional patterns (HTTP, gRPC, MCP)",
      "file": ["internal/server/*.go", "internal/transport/*.go"],
      "status": "pending",
      "files_affected": ["error_code_audit.txt"],
      "verification": "Error codes follow conventions, no duplicates"
    },
    {
      "id": "TEST-044",
      "task": "Add integration test for script timeout enforcement (verify SIGTERM on timeout)",
      "file": "integration/script_timeout_test.go",
      "status": "pending",
      "files_affected": ["integration/script_timeout_test.go"],
      "verification": "Scripts terminated on timeout, resources cleaned"
    },
    {
      "id": "TEST-045",
      "task": "Verify all exported Go types have godoc comments (package, type, function)",
      "file": "internal/",
      "status": "complete",
      "files_affected": ["internal/**/*.go"],
      "verification": "godoc generates complete documentation - all exports documented"
    },
    {
      "id": "TEST-046",
      "task": "Add integration test for wait element timeout behavior (verify no stuck wait)",
      "file": "integration/wait_timeout_test.go",
      "status": "pending",
      "files_affected": ["integration/wait_timeout_test.go"],
      "verification": "Wait operations timeout correctly and return error"
    },
    {
      "id": "TEST-047",
      "task": "Add fuzz testing harness for proto message parsing (go test -fuzz FuzzProto)",
      "file": "internal/server/fuzz_test.go",
      "status": "pending",
      "files_affected": ["internal/server/fuzz_test.go"],
      "verification": "Fuzz harness runs without crashes on corpus"
    },
    {
      "id": "TEST-048",
      "task": "Add integration test for clipboard race conditions (concurrent read/write)",
      "file": "integration/clipboard_race_test.go",
      "status": "pending",
      "files_affected": ["integration/clipboard_race_test.go"],
      "verification": "Concurrent clipboard operations handled without corruption"
    },
    {
      "id": "TEST-049",
      "task": "Add integration test for observation buffer overflow (rapid event generation)",
      "file": "integration/observation_stress_test.go",
      "status": "pending",
      "files_affected": ["integration/observation_stress_test.go"],
      "verification": "Observation buffer handles overflow gracefully"
    },
    {
      "id": "TEST-050",
      "task": "Verify gRPC reflection service is accessible and lists all RPCs correctly",
      "file": "Server/Sources/MacosUseServer/main.swift",
      "status": "pending",
      "files_affected": ["grpc_reflection_test.txt"],
      "verification": "grpcurl -plaintext localhost:50051 list returns all services"
    },
    {
      "id": "DOC-001",
      "task": "Verify coordinate system documentation matches implementation (Global Display Coordinates everywhere)",
      "file": ["proto/macosusesdk/v1/*.proto", "internal/server/*.go", "Server/Sources/MacosUseServer/*.swift"],
      "status": "pending",
      "files_affected": ["docs/10-api-reference.md", "docs/02-window-state-management.md"],
      "verification": "All coordinate references specify Global Display Coordinates (top-left origin)"
    },
    {
      "id": "DOC-002",
      "task": "Verify all environment variables are documented in API reference with defaults and examples",
      "file": ["internal/config/config.go", "cmd/macos-use-mcp/", "docs/10-api-reference.md"],
      "status": "pending",
      "files_affected": ["docs/10-api-reference.md"],
      "verification": "All env vars documented with type, default, and example"
    },
    {
      "id": "DOC-003",
      "task": "Add disaster recovery documentation (server crash, database corruption, network partition scenarios)",
      "file": "docs/11-disaster-recovery.md",
      "status": "pending",
      "files_affected": ["docs/11-disaster-recovery.md"],
      "verification": "Documentation covers all failure scenarios with recovery steps"
    },
    {
      "id": "DOC-004",
      "task": "Add API version migration guide between beta and stable",
      "file": "docs/12-migration-guide.md",
      "status": "pending",
      "files_affected": ["docs/12-migration-guide.md"],
      "verification": "Guide covers breaking changes and migration path"
    },
    {
      "id": "DOC-005",
      "task": "Define and document API deprecation policy (support timeline, notice period, breaking change process)",
      "file": "docs/13-deprecation-policy.md",
      "status": "pending",
      "files_affected": ["docs/13-deprecation-policy.md"],
      "verification": "Policy defined with clear timelines and process"
    },
    {
      "id": "DOC-006",
      "task": "Add performance monitoring dashboard documentation (Prometheus queries, alerts, Grafana dashboards)",
      "file": "docs/14-observability-dashboard.md",
      "status": "pending",
      "files_affected": ["docs/14-observability-dashboard.md"],
      "verification": "Documentation includes sample queries and alert rules"
    },
    {
      "id": "DOC-007",
      "task": "Verify all proto messages have proper descriptive comments (godoc compatibility)",
      "file": "proto/macosusesdk/v1/*.proto",
      "status": "pending",
      "files_affected": ["proto/macosusesdk/v1/*.proto"],
      "verification": "All exported types and services have descriptive comments"
    },
    {
      "id": "LOG-001",
      "task": "Verify Logger usage with OSLogPrivacy in all Swift server components (Server/Sources/MacosUseServer/)",
      "file": "Server/Sources/MacosUseServer/",
      "status": "complete",
      "files_affected": ["Server/Sources/MacosUseServer/*.swift"],
      "verification": "All log statements use Logger with privacy annotations - 7 violations fixed"
    },
    {
      "id": "LOG-002",
      "task": "Verify Logger usage in internal/ directory Go code (no fputs or unannotated print)",
      "file": "internal/",
      "status": "complete",
      "files_affected": ["internal/**/*.go"],
      "verification": "All diagnostic logs use Logger, no fputs usage - Go uses idiomatic log package"
    },
    {
      "id": "MCP-001",
      "task": "Verify all 77 MCP tools are accessible via both stdio and SSE transports",
      "file": "cmd/macos-use-mcp/",
      "status": "pending",
      "files_affected": ["cmd/macos-use-mcp/main.go", "internal/transport/"],
      "verification": "Test all tools via both transport modes"
    },
    {
      "id": "MCP-002",
      "task": "Add integration test for SSE reconnection with Last-Event-ID replay",
      "file": "integration/http_transport_test.go",
      "status": "pending",
      "files_affected": ["integration/http_transport_test.go"],
      "verification": "SSE reconnection replays missed events using Last-Event-ID"
    },
    {
      "id": "MCP-003",
      "task": "Verify Google AIP-158 compliance on all List/Find RPCs (page_size, page_token, next_page_token opaque)",
      "file": "proto/macosusesdk/v1/",
      "status": "pending",
      "files_affected": ["proto/macosusesdk/v1/*.proto", "internal/server/*.go"],
      "verification": "All pagination implementations treat tokens as opaque"
    },
    {
      "id": "SEC-001",
      "task": "Run third-party security audit (Go sec, Swift package audit) and address findings",
      "file": ["go.mod", "Package.swift"],
      "status": "pending",
      "files_affected": ["security_audit_report.txt"],
      "verification": "No high-severity vulnerabilities, all addressed"
    },
    {
      "id": "SEC-002",
      "task": "Add integration test for shell command security (command injection prevention)",
      "file": "integration/shell_security_test.go",
      "status": "pending",
      "files_affected": ["integration/shell_security_test.go", "internal/server/scripting_test.go"],
      "verification": "Shell command injection attempts are blocked"
    },
    {
      "id": "PERF-001",
      "task": "Add benchmark tests for core operations (ListWindows, FindElements, Click, Input)",
      "file": ["internal/server/*_bench_test.go"],
      "status": "pending",
      "files_affected": ["internal/server/*_bench_test.go"],
      "verification": "Benchmark tests run successfully and establish baselines"
    },
    {
      "id": "PERF-002",
      "task": "Verify all error messages are actionable (include context and suggested fix)",
      "file": ["internal/server/*.go", "internal/transport/*.go", "Server/Sources/MacosUseServer/*.swift"],
      "status": "pending",
      "files_affected": ["internal/*.go", "Server/Sources/MacosUseServer/*.swift"],
      "verification": "All error messages provide clear next steps for resolution"
    },
    {
      "id": "INT-001",
      "task": "Add integration test for session isolation (multiple sessions do not interfere)",
      "file": "integration/session_isolation_test.go",
      "status": "pending",
      "files_affected": ["integration/session_isolation_test.go"],
      "verification": "Concurrent session operations are properly isolated"
    },
    {
      "id": "INT-002",
      "task": "Add integration test for macro recording (capture actions, replay verification)",
      "file": "integration/macro_record_test.go",
      "status": "pending",
      "files_affected": ["integration/macro_record_test.go"],
      "verification": "Macro recording captures actions correctly and replays identically"
    },
    {
      "id": "INT-003",
      "task": "Add integration test for accessibility traversal performance on large trees",
      "file": "integration/traversal_performance_test.go",
      "status": "pending",
      "files_affected": ["integration/traversal_performance_test.go"],
      "verification": "Traversal completes within acceptable time for 1000+ element trees"
    },
    {
      "id": "INT-004",
      "task": "Add integration test for window ID regeneration handling (post-mutation ID mismatch)",
      "file": "integration/window_id_regeneration_test.go",
      "status": "pending",
      "files_affected": ["integration/window_id_regeneration_test.go"],
      "verification": "Tests handle ID regeneration after window mutations gracefully"
    },
    {
      "id": "INT-005",
      "task": "Add chaos engineering test (simulate intermittent failures, recover gracefully)",
      "file": "integration/chaos_test.go",
      "status": "pending",
      "files_affected": ["integration/chaos_test.go"],
      "verification": "System recovers from intermittent failures without data loss"
    },
    {
      "id": "INT-006",
      "task": "Add integration test for resource naming consistency (verify all resource names match AIP patterns)",
      "file": "integration/resource_naming_test.go",
      "status": "pending",
      "files_affected": ["internal/server/*.go"],
      "verification": "All resources follow AIP resource naming guidelines"
    },
    {
      "id": "FINAL-001",
      "task": "Run first peer review via subagent to guarantee correctness of all implementation work",
      "file": "./",
      "status": "pending",
      "files_affected": ["blueprint.json"],
      "verification": "Subagent confirms all implementation is correct and production-ready"
    },
    {
      "id": "FINAL-002",
      "task": "Run second peer review via subagent to guarantee production readiness",
      "file": "./",
      "status": "pending",
      "files_affected": ["blueprint.json"],
      "verification": "Second subagent confirms no issues remaining, guarantee achieved"
    },
    {
      "id": "FINAL-003",
      "task": "Commit all production-ready changes (all tasks complete, tests passing)",
      "file": "./",
      "status": "pending",
      "files_affected": ["blueprint.json"],
      "verification": "Git diff shows all tasks completed, no TODO/FIXME remaining"
    },
    {
      "id": "FINAL-004",
      "task": "Trigger final CI run and verify green (all checks pass, integration tests complete under time limit)",
      "file": ".github/workflows/ci.yaml",
      "status": "pending",
      "files_affected": ["build.log"],
      "verification": "GitHub Actions CI passes cleanly with all green checks"
    },
    {
      "id": "FINAL-005",
      "task": "Add v1.0.0 release documentation (release notes, upgrade path, breaking changes)",
      "file": "RELEASE_NOTES.md",
      "status": "pending",
      "files_affected": ["RELEASE_NOTES.md", "CHANGELOG.md"],
      "verification": "Release notes complete with all sections"
    },
    {
      "id": "FINAL-006",
      "task": "Verify no warnings or deprecations in Swift package compilation",
      "file": "Server/",
      "status": "pending",
      "files_affected": ["build.log"],
      "verification": "Swift compiler emits no warnings or deprecations"
    },
    {
      "id": "FINAL-007",
      "task": "Run final full CI simulation locally (include all test suites, lint, api-linter)",
      "file": "build.log",
      "status": "pending",
      "files_affected": ["build.log"],
      "verification": "All checks pass: go test, swift test, go vet, staticcheck, api-linter"
    }
  ]
}
