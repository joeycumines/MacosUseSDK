gRPC methods for MacosUse service

Summary observations

- Implementation status: Server-side implementations exist for every RPC in proto/macosusesdk/v1/macos_use.proto (handlers and helpers present in Server/Sources/MacosUseServer).
- Unit tests: Several server components are unit-tested (window registry/methods, app-state store, observation manager, scripting and system operations). Many RPC wrapper functions themselves are thin adapters and have limited direct unit tests.
- Integration tests: There is comprehensive integration coverage for user-level flows: applications lifecycle, List/Find elements pagination, clipboard flows, scripting (AppleScript), and observation pagination/cancellation. Several lower-level or desktop-only features (file dialogs, macros, screenshots, many element actions) lack corresponding integration tests.
- Viability: The API surface appears implemented end-to-end (proto + server + integration tests for core flows). Missing tests on some methods reduce confidence but do not prevent viability; many features depend on macOS-specific behaviour and runtime environment (so integration runs require macOS with accessibility permissions).

| Service  |                      RPC | Request                         | Response                                                | Streaming     | Impl file(s)                                                                                                             | Unit tests                                                | Integration tests                                                         | Notes                                                                                       |
|----------|-------------------------:|---------------------------------|---------------------------------------------------------|---------------|--------------------------------------------------------------------------------------------------------------------------|-----------------------------------------------------------|---------------------------------------------------------------------------|---------------------------------------------------------------------------------------------|
| MacosUse |          OpenApplication | OpenApplicationRequest          | google.longrunning.Operation / OpenApplicationResponse  | no (LRO)      | Server/Sources/MacosUseServer/ApplicationMethods.swift; Server/Sources/MacosUseProto/macosusesdk/v1/macos_use.grpc.swift | No                                                        | Yes — integration/main_test.go, integration/calculator_test.go            | Starts app as LRO; integration coverage present                                             |
| MacosUse |           GetApplication | GetApplicationRequest           | Application                                             | no            | Server/Sources/MacosUseServer/ApplicationMethods.swift                                                                   | No                                                        | Yes — integration/lifecycle_test.go                                       |                                                                                             |
| MacosUse |         ListApplications | ListApplicationsRequest         | ListApplicationsResponse                                | no            | Server/Sources/MacosUseServer/ApplicationMethods.swift                                                                   | No                                                        | Yes — integration/* (multiple tests)                                      | Pagination tests present                                                                    |
| MacosUse |        DeleteApplication | DeleteApplicationRequest        | google.protobuf.Empty                                   | no            | Server/Sources/MacosUseServer/ApplicationMethods.swift                                                                   | No                                                        | Yes — integration/main_test.go, integration/apiutil_test.go               | Deletes tracking; integration tested                                                        |
| MacosUse |              CreateInput | CreateInputRequest              | Input                                                   | no            | Server/Sources/MacosUseServer/InputMethods.swift                                                                         | Yes — AppStateStoreTests exercise related store functions | Yes — integration/apiutil_test.go, integration/hidden_state_test.go       | Server implements creation + store logic                                                    |
| MacosUse |                 GetInput | GetInputRequest                 | Input                                                   | no            | Server/Sources/MacosUseServer/InputMethods.swift                                                                         | Yes — AppStateStoreTests                                  | Yes — integration/apiutil_test.go                                         |                                                                                             |
| MacosUse |               ListInputs | ListInputsRequest               | ListInputsResponse                                      | no            | Server/Sources/MacosUseServer/InputMethods.swift                                                                         | Yes — AppStateStoreTests                                  | Yes — integration/pagination_test.go, integration/apiutil_test.go         | Pagination covered in integration tests                                                     |
| MacosUse |    TraverseAccessibility | TraverseAccessibilityRequest    | TraverseAccessibilityResponse                           | no            | Server/Sources/MacosUseServer/ElementMethods.swift                                                                       | No                                                        | Yes — integration/calculator_test.go                                      | Traversal implemented, integration tested                                                   |
| MacosUse |       WatchAccessibility | WatchAccessibilityRequest       | stream WatchAccessibilityResponse                       | server-stream | Server/Sources/MacosUseServer/ElementMethods.swift                                                                       | No                                                        | No evidence in integration tests                                          | Server supports streaming but not covered in integration tests                              |
| MacosUse |                GetWindow | GetWindowRequest                | Window                                                  | no            | Server/Sources/MacosUseServer/WindowMethods.swift; WindowRegistry.swift                                                  | Yes — WindowRegistryTests, WindowMethodsTests             | Yes — integration/* (multiple tests)                                      | Hybrid authority semantics tested in unit tests                                             |
| MacosUse |              ListWindows | ListWindowsRequest              | ListWindowsResponse                                     | no            | Server/Sources/MacosUseServer/WindowMethods.swift                                                                        | Yes — WindowMethodsTests, WindowRegistryTests             | Yes — integration/pagination_test.go, integration/calculator_test.go      | Pagination & filtering tested in integration and unit tests                                 |
| MacosUse |           GetWindowState | GetWindowStateRequest           | WindowState                                             | no            | Server/Sources/MacosUseServer/WindowMethods.swift, WindowHelpers.swift                                                   | Yes — WindowMethodsTests                                  | No integration test found                                                 | Strong unit coverage for AX state retrieval                                                 |
| MacosUse |              FocusWindow | FocusWindowRequest              | Window                                                  | no            | Server/Sources/MacosUseServer/WindowMethods.swift                                                                        | No                                                        | No                                                                        | Implemented but not prominently tested in integration suite                                 |
| MacosUse |               MoveWindow | MoveWindowRequest               | Window                                                  | no            | Server/Sources/MacosUseServer/WindowMethods.swift                                                                        | No                                                        | No                                                                        | Implemented; low integration coverage                                                       |
| MacosUse |             ResizeWindow | ResizeWindowRequest             | Window                                                  | no            | Server/Sources/MacosUseServer/WindowMethods.swift                                                                        | No                                                        | No                                                                        |                                                                                             |
| MacosUse |           MinimizeWindow | MinimizeWindowRequest           | Window                                                  | no            | Server/Sources/MacosUseServer/WindowMethods.swift                                                                        | No                                                        | No                                                                        |                                                                                             |
| MacosUse |            RestoreWindow | RestoreWindowRequest            | Window                                                  | no            | Server/Sources/MacosUseServer/WindowMethods.swift                                                                        | No                                                        | No                                                                        |                                                                                             |
| MacosUse |              CloseWindow | CloseWindowRequest              | CloseWindowResponse                                     | no            | Server/Sources/MacosUseServer/WindowMethods.swift                                                                        | No                                                        | No                                                                        | CloseWindow implemented; not covered by integration tests                                   |
| MacosUse |             FindElements | FindElementsRequest             | FindElementsResponse                                    | no            | Server/Sources/MacosUseServer/ElementMethods.swift; ElementLocator.swift                                                 | No                                                        | Yes — integration/pagination_find_test.go, integration/pagination_test.go | Pagination & region handling tested                                                         |
| MacosUse |       FindRegionElements | FindRegionElementsRequest       | FindRegionElementsResponse                              | no            | Server/Sources/MacosUseServer/ElementMethods.swift; ElementLocator.swift                                                 | No                                                        | Yes — integration/pagination_find_test.go                                 |                                                                                             |
| MacosUse |               GetElement | GetElementRequest               | macosusesdk.type.Element                                | no            | Server/Sources/MacosUseServer/ElementMethods.swift; ElementRegistry.swift                                                | No                                                        | No integration tests found                                                | Element registry exists; no dedicated unit tests found in repo                              |
| MacosUse |             ClickElement | ClickElementRequest             | ClickElementResponse                                    | no            | Server/Sources/MacosUseServer/ElementMethods.swift                                                                       | No                                                        | No                                                                        | Implemented but not covered by integration tests                                            |
| MacosUse |        WriteElementValue | WriteElementValueRequest        | WriteElementValueResponse                               | no            | Server/Sources/MacosUseServer/ElementMethods.swift                                                                       | No                                                        | No                                                                        |                                                                                             |
| MacosUse |        GetElementActions | GetElementActionsRequest        | ElementActions                                          | no            | Server/Sources/MacosUseServer/ElementMethods.swift                                                                       | No                                                        | No                                                                        |                                                                                             |
| MacosUse |     PerformElementAction | PerformElementActionRequest     | PerformElementActionResponse                            | no            | Server/Sources/MacosUseServer/ElementMethods.swift                                                                       | No                                                        | No                                                                        |                                                                                             |
| MacosUse |              WaitElement | WaitElementRequest              | google.longrunning.Operation / WaitElementResponse      | no (LRO)      | Server/Sources/MacosUseServer/ElementMethods.swift; OperationStore.swift                                                 | No                                                        | No                                                                        | LRO-based waiting implemented; no integration tests found                                   |
| MacosUse |         WaitElementState | WaitElementStateRequest         | google.longrunning.Operation / WaitElementStateResponse | no (LRO)      | Server/Sources/MacosUseServer/ElementMethods.swift                                                                       | No                                                        | No                                                                        |                                                                                             |
| MacosUse |        CreateObservation | CreateObservationRequest        | google.longrunning.Operation / Observation              | no (LRO)      | Server/Sources/MacosUseServer/ObservationMethods.swift; ObservationManager.swift                                         | Yes — ObservationManagerTests                             | Yes — integration/pagination_find_test.go (create/cancel/stream flows)    | Observation LROs are implemented and tested in integration for pagination and cancellation  |
| MacosUse |           GetObservation | GetObservationRequest           | Observation                                             | no            | Server/Sources/MacosUseServer/ObservationMethods.swift; ObservationManager.swift                                         | Yes — ObservationManagerTests                             | Yes — integration/pagination_find_test.go                                 |                                                                                             |
| MacosUse |         ListObservations | ListObservationsRequest         | ListObservationsResponse                                | no            | Server/Sources/MacosUseServer/ObservationMethods.swift; ObservationManager.swift                                         | Yes — ObservationManagerTests                             | Yes — integration/pagination_find_test.go                                 | Pagination tested in integration tests                                                      |
| MacosUse |        CancelObservation | CancelObservationRequest        | Observation                                             | no            | Server/Sources/MacosUseServer/ObservationMethods.swift; ObservationManager.swift                                         | Yes — ObservationManagerTests                             | Yes — integration/pagination_find_test.go                                 | Cancellation covered by integration test helper flows                                       |
| MacosUse |       StreamObservations | StreamObservationsRequest       | stream StreamObservationsResponse                       | server-stream | Server/Sources/MacosUseServer/ObservationMethods.swift                                                                   | No                                                        | No explicit integration streaming test found                              | Server supports streaming; limited direct integration coverage                              |
| MacosUse |            CreateSession | CreateSessionRequest            | Session                                                 | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        | Session management implemented but not covered in integration tests                         |
| MacosUse |               GetSession | GetSessionRequest               | Session                                                 | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        |                                                                                             |
| MacosUse |             ListSessions | ListSessionsRequest             | ListSessionsResponse                                    | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        |                                                                                             |
| MacosUse |            DeleteSession | DeleteSessionRequest            | google.protobuf.Empty                                   | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        |                                                                                             |
| MacosUse |         BeginTransaction | BeginTransactionRequest         | BeginTransactionResponse                                | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        |                                                                                             |
| MacosUse |        CommitTransaction | CommitTransactionRequest        | Transaction                                             | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        | Unit-level commit/rollback functions exist (SessionManager) but integration coverage absent |
| MacosUse |      RollbackTransaction | RollbackTransactionRequest      | Transaction                                             | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        |                                                                                             |
| MacosUse |       GetSessionSnapshot | GetSessionSnapshotRequest       | SessionSnapshot                                         | no            | Server/Sources/MacosUseServer/SessionMethods.swift; SessionManager.swift                                                 | No                                                        | No                                                                        | Snapshot support implemented in manager                                                     |
| MacosUse |        CaptureScreenshot | CaptureScreenshotRequest        | CaptureScreenshotResponse                               | no            | Server/Sources/MacosUseServer/CaptureMethods.swift; ScreenshotCapture.swift                                              | No                                                        | No                                                                        | No integration tests for screenshots in repo                                                |
| MacosUse |  CaptureWindowScreenshot | CaptureWindowScreenshotRequest  | CaptureWindowScreenshotResponse                         | no            | Server/Sources/MacosUseServer/WindowMethods.swift; CaptureMethods.swift                                                  | No                                                        | No                                                                        |                                                                                             |
| MacosUse | CaptureElementScreenshot | CaptureElementScreenshotRequest | CaptureElementScreenshotResponse                        | no            | Server/Sources/MacosUseServer/CaptureMethods.swift                                                                       | No                                                        | No                                                                        |                                                                                             |
| MacosUse |  CaptureRegionScreenshot | CaptureRegionScreenshotRequest  | CaptureRegionScreenshotResponse                         | no            | Server/Sources/MacosUseServer/CaptureMethods.swift                                                                       | No                                                        | No                                                                        |                                                                                             |
| MacosUse |             GetClipboard | GetClipboardRequest             | Clipboard                                               | no            | Server/Sources/MacosUseServer/ClipboardMethods.swift; ClipboardManager.swift                                             | No                                                        | Yes — integration/clipboard_test.go                                       | Clipboard has robust integration tests                                                      |
| MacosUse |           WriteClipboard | WriteClipboardRequest           | WriteClipboardResponse                                  | no            | Server/Sources/MacosUseServer/ClipboardMethods.swift; ClipboardManager.swift                                             | No                                                        | Yes — integration/clipboard_test.go                                       |                                                                                             |
| MacosUse |           ClearClipboard | ClearClipboardRequest           | ClearClipboardResponse                                  | no            | Server/Sources/MacosUseServer/ClipboardMethods.swift; ClipboardManager.swift                                             | No                                                        | Yes — integration/clipboard_test.go                                       |                                                                                             |
| MacosUse |      GetClipboardHistory | GetClipboardHistoryRequest      | ClipboardHistory                                        | no            | Server/Sources/MacosUseServer/ClipboardMethods.swift; ClipboardManager.swift                                             | No                                                        | Yes — integration/clipboard_test.go                                       | History integration tested                                                                  |
| MacosUse |   AutomateOpenFileDialog | AutomateOpenFileDialogRequest   | AutomateOpenFileDialogResponse                          | no            | Server/Sources/MacosUseServer/FileDialogMethods.swift; FileDialogAutomation.swift                                        | No                                                        | No                                                                        | Implemented via FileDialogAutomation helpers; no integration tests found                    |
| MacosUse |   AutomateSaveFileDialog | AutomateSaveFileDialogRequest   | AutomateSaveFileDialogResponse                          | no            | Server/Sources/MacosUseServer/FileDialogMethods.swift; FileDialogAutomation.swift                                        | No                                                        | No                                                                        |                                                                                             |
| MacosUse |               SelectFile | SelectFileRequest               | SelectFileResponse                                      | no            | Server/Sources/MacosUseServer/FileDialogMethods.swift; FileDialogAutomation.swift                                        | No                                                        | No                                                                        |                                                                                             |
| MacosUse |          SelectDirectory | SelectDirectoryRequest          | SelectDirectoryResponse                                 | no            | Server/Sources/MacosUseServer/FileDialogMethods.swift; FileDialogAutomation.swift                                        | No                                                        | No                                                                        |                                                                                             |
| MacosUse |                DragFiles | DragFilesRequest                | DragFilesResponse                                       | no            | Server/Sources/MacosUseServer/FileDialogMethods.swift; FileDialogAutomation.swift                                        | No                                                        | No                                                                        |                                                                                             |
| MacosUse |              CreateMacro | CreateMacroRequest              | Macro                                                   | no            | Server/Sources/MacosUseServer/MacroMethods.swift; MacroRegistry.swift                                                    | No                                                        | No                                                                        | Macro storage/registry implemented; no tests found in repo                                  |
| MacosUse |                 GetMacro | GetMacroRequest                 | Macro                                                   | no            | Server/Sources/MacosUseServer/MacroMethods.swift; MacroRegistry.swift                                                    | No                                                        | No                                                                        |                                                                                             |
| MacosUse |               ListMacros | ListMacrosRequest               | ListMacrosResponse                                      | no            | Server/Sources/MacosUseServer/MacroMethods.swift; MacroRegistry.swift                                                    | No                                                        | No                                                                        |                                                                                             |
| MacosUse |              UpdateMacro | UpdateMacroRequest              | Macro                                                   | no            | Server/Sources/MacosUseServer/MacroMethods.swift; MacroRegistry.swift                                                    | No                                                        | No                                                                        |                                                                                             |
| MacosUse |              DeleteMacro | DeleteMacroRequest              | google.protobuf.Empty                                   | no            | Server/Sources/MacosUseServer/MacroMethods.swift; MacroRegistry.swift                                                    | No                                                        | No                                                                        |                                                                                             |
| MacosUse |             ExecuteMacro | ExecuteMacroRequest             | google.longrunning.Operation / ExecuteMacroResponse     | no (LRO)      | Server/Sources/MacosUseServer/MacroMethods.swift; MacroExecutor.swift                                                    | No                                                        | No                                                                        | Execution orchestrator implemented; no tests found in repo                                  |
| MacosUse |       ExecuteAppleScript | ExecuteAppleScriptRequest       | ExecuteAppleScriptResponse                              | no            | Server/Sources/MacosUseServer/ScriptingMethods.swift; ScriptExecutor.swift                                               | Yes — ScriptingMethodsTests, ScriptExecutor unit tests    | Yes — integration/hidden_state_test.go, integration/pagination_test.go    | Scripts are used across integration tests                                                   |
| MacosUse |        ExecuteJavaScript | ExecuteJavaScriptRequest        | ExecuteJavaScriptResponse                               | no            | Server/Sources/MacosUseServer/ScriptingMethods.swift; ScriptExecutor.swift                                               | Yes — ScriptExecutor tests                                | No                                                                        |                                                                                             |
| MacosUse |      ExecuteShellCommand | ExecuteShellCommandRequest      | ExecuteShellCommandResponse                             | no            | Server/Sources/MacosUseServer/ScriptingMethods.swift; ScriptExecutor.swift                                               | Yes — ScriptExecutor tests                                | No                                                                        |                                                                                             |
| MacosUse |           ValidateScript | ValidateScriptRequest           | ValidateScriptResponse                                  | no            | Server/Sources/MacosUseServer/ScriptingMethods.swift; ScriptExecutor.swift                                               | Yes — ScriptExecutor tests                                | No                                                                        |                                                                                             |
| MacosUse | GetScriptingDictionaries | GetScriptingDictionariesRequest | ScriptingDictionaries                                   | no            | Server/Sources/MacosUseServer/ScriptingMethods.swift                                                                     | Yes — ScriptingMethodsTests                               | No                                                                        | Unit tests exist for `getScriptingDictionaries`                                             |
